<!doctype html>
<html lang="en-GB" dir="ltr" class="docs-wrapper docs-doc-page docs-version-1.0.0 plugin-docs plugin-id-default docs-doc-id-3scale/3scale_publish_ogc_web_services">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<script src="https://buttons.github.io/buttons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
<script src="https://github.com/CivityNL/civity-docs/blob/gh-pages/js/code-block-buttons.js"></script><title data-rh="true">Publish OGC web services | Civity Docs</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://CivityNL.github.io/civity-docs/en/docs/1.0.0/3scale/3scale_publish_ogc_web_services"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.0.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.0.0"><meta data-rh="true" name="docsearch:version" content="1.0.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.0.0"><meta data-rh="true" property="og:title" content="Publish OGC web services | Civity Docs"><meta data-rh="true" name="description" content="Register an OGC service endpoint"><meta data-rh="true" property="og:description" content="Register an OGC service endpoint"><link data-rh="true" rel="icon" href="/en/img/civityHexLogo.png"><link data-rh="true" rel="canonical" href="https://CivityNL.github.io/civity-docs/en/docs/1.0.0/3scale/3scale_publish_ogc_web_services"><link data-rh="true" rel="alternate" href="https://CivityNL.github.io/civity-docs/docs/1.0.0/3scale/3scale_publish_ogc_web_services" hreflang="nl"><link data-rh="true" rel="alternate" href="https://CivityNL.github.io/civity-docs/en/docs/1.0.0/3scale/3scale_publish_ogc_web_services" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://CivityNL.github.io/civity-docs/sv/docs/1.0.0/3scale/3scale_publish_ogc_web_services" hreflang="sv"><link data-rh="true" rel="alternate" href="https://CivityNL.github.io/civity-docs/docs/1.0.0/3scale/3scale_publish_ogc_web_services" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://HSXU31YQHK-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/en/assets/css/styles.0a2882b7.css">
<link rel="preload" href="/en/assets/js/runtime~main.a429d5f6.js" as="script">
<link rel="preload" href="/en/assets/js/main.72950437.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><b class="navbar__title text--truncate">Civity Docs</b></a><a class="navbar__item navbar__link" href="/en/docs/Welcome">Welcome</a><a class="navbar__item navbar__link" href="/en/dataplatform/dataplatform_introduction">DataPlatform</a><a class="navbar__item navbar__link" href="/en/datacatalogus/korte_intro">DataCatalogus</a><a class="navbar__item navbar__link" href="/en/slimmelden/slimmelden">Slim Melden</a><a class="navbar__item navbar__link" href="/en/slimbeheer/slimbeheer">Slim Beheer</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/en/help">Help</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_dNtB"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/1.0.0/3scale/3scale_publish_ogc_web_services" target="_self" rel="noopener noreferrer" class="dropdown__link">Nederlands</a></li><li><a href="/en/docs/1.0.0/3scale/3scale_publish_ogc_web_services" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/sv/docs/1.0.0/3scale/3scale_publish_ogc_web_services" target="_self" rel="noopener noreferrer" class="dropdown__link">Svenska</a></li></ul></div><div class="searchBox_dLyj"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><main class="docMainContainer_uL0j docMainContainerEnhanced_oQfM"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Civity Docs<!-- --> <b>1.0.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/en/docs/Welcome">latest version</a></b> (<!-- -->1.0.1<!-- -->).</div></div><div class="docItemContainer_vinB"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 1.0.0</span><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Publish OGC web services</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="register-an-ogc-service-endpoint">Register an OGC service endpoint<a class="hash-link" href="#register-an-ogc-service-endpoint" title="Direct link to heading">​</a></h2><p>We create a new Product called <!-- -->&#x27;<!-- -->OGC<!-- -->&#x27;</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc01-2fe413fba901b0760aa0550da2790c87.png" class="img_E7b_"><p>Under Product/Integration/Backends we define the new API endpoint and its public path.</p><p><em>For the OGC services we have two options on defining the access points. We can either define straight from inside the Geoserver URL, by defining the appropriate workspace to give access, or through the geoserver redirection from inside the appropriate CKAN instance. For example, we could have these two options:</em></p><ol><li>http://{geoserverURL}:8080/geoserver/workspace<em>datastore</em>{ckanInstance}/ows <em>or</em></li><li>https://{ckanInstance}.dataplatform.nl/ows</li></ol><p><em>We select the second option as it is better manageable under the 3scale API management:</em></p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc02-03926973de063050aeb4ddf061866a62.png" class="img_E7b_"><p>We set the Public Path to /ogc.</p><p>Through OGC services, we want to make available three available requests: WMS/ WFS/ WCS. In order to manage these requests separately for better management and overview of their use, we define three new methods, navigating to Backend/Methods <!-- -->&amp;<!-- --> Metrics:</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc03-4a692e07d929f1a1a141f25e4d3faab8.png" class="img_E7b_"><p>This will help us to register our API specific endpoints with these methods under Mapping Rules:</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc04-cb6b5d6462dabf0e8410ba3c20fd9a57.png" class="img_E7b_"><p>These endpoints are coming straight forward from the ckan instance as mentioned above (option 2). For that reason we need to define the CKAN API key under 3scale configuration.</p><p>3scale has a build-in function to modify the Headers to include custom ones. In our case, we want to include the key Authorization with its value (CKAN API key).</p><p><em>*<!-- -->In the case we were choosing option 1 accessing OGC services directly from the geoserver machine, we would need to include in the Headers the geoserver credentials (username/password).</em></p><p>To succeed this, we navigate to Product/Integration/Policies and we click on Add policy and choose Header Modification. We choose the operation to be for a request, set the key name and the value.</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc05-475cd3cc7eeaf3e64a98ec8785e011b2.png" class="img_E7b_"><h2 class="anchor anchorWithStickyNavbar_mojV" id="publish-the-ogc-services">Publish the OGC services<a class="hash-link" href="#publish-the-ogc-services" title="Direct link to heading">​</a></h2><p><strong>After applying all these additions and changes, we still have to navigate to Product/Integration/ /Configuration and promote the APIcast Configuration for these changes to be saved and published.</strong></p><p>After publishing for the first time and trying to access one of the OGC endpoints, we get the error <!-- -->&quot;<!-- -->Authentication parameters missing<!-- -->&quot;<!-- -->.</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc06-9fd3ba8a72c91773129da505f18620c1.png" class="img_E7b_"><p>This has to do with the fact that the API endpoint arguments mix up with the 3scale credentials location. The default 3scale configuration defines the auth user key as a query parameter and in order to fix the encountered error, we need to convert this to an HTTP Header.</p><p>Navigating to Product/Integration/Settings we are able to set the 3scale auth user key to be acquired from the HTTP Headers, option as HTTP Headers. This fixes the encountered error.</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc07-d4625908cec7d07c23823c237634c26c.png" class="img_E7b_"><h2 class="anchor anchorWithStickyNavbar_mojV" id="restricting-access-to-our-backend-methods">Restricting access to our Backend Methods<a class="hash-link" href="#restricting-access-to-our-backend-methods" title="Direct link to heading">​</a></h2><p>Navigating to Product/Applications/Application Plans and choosing a plan, we can set pricing and limits to our already specified methods, and even restrict their use by disabling them.</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc08-72470ae89a3bfaa0dc8b366e7776362a.png" class="img_E7b_"><h2 class="anchor anchorWithStickyNavbar_mojV" id="statistics">Statistics<a class="hash-link" href="#statistics" title="Direct link to heading">​</a></h2><p>The methods we defined for our API calls are also visible in the statistics section. Navigate to Product/Analytics/Traffic to get an overview of the OGC services use.</p><img loading="lazy" class="img-fluid" src="/en/assets/images/ogc09-6a82b9ff05439f084e6520a1dd1deb80.png" class="img_E7b_"></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/CivityNL/civity-docs-edit/edit/drafts/website/versioned_docs/version-1.0.0/3scale/3scale_publish_ogc_web_services.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-05-27T13:17:42.000Z">5/27/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#register-an-ogc-service-endpoint" class="table-of-contents__link toc-highlight">Register an OGC service endpoint</a></li><li><a href="#publish-the-ogc-services" class="table-of-contents__link toc-highlight">Publish the OGC services</a></li><li><a href="#restricting-access-to-our-backend-methods" class="table-of-contents__link toc-highlight">Restricting access to our Backend Methods</a></li><li><a href="#statistics" class="table-of-contents__link toc-highlight">Statistics</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/en/img/civityHexLogo.png" class="themedImage_W2Cr themedImage--light_TfLj footer__logo"><img src="/en/img/civityHexLogo.png" class="themedImage_W2Cr themedImage--dark_oUvU footer__logo"></div><div class="footer__copyright">Copyright © 2022 Civity B.V.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.a429d5f6.js"></script>
<script src="/en/assets/js/main.72950437.js"></script>
</body>
</html>